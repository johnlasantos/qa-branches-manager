import{r as a,j as e,S as _,q as H,s as L,v as M,w as ee}from"./vendor-D1edepek.js";import{B as C}from"./button-IneqVM9s.js";import{I as se,S as re,B as ne}from"./BranchIcon-BWE1_hKG.js";import{c as o,T as w,a as N,b as y,d as b}from"./App-jtuI45iU.js";import{A as D,a as T,b as $,c as A,d as R,e as S,f as B,g as z,h as O}from"./alert-dialog-Co8LTfw-.js";import"./index-gRCzXA7N.js";const xe=({branches:P,onSwitchBranch:Y,onDeleteBranch:G,onUpdateCurrentBranch:J,onScrollEnd:m,hasMore:d=!1,className:x,isLoading:i=!1,isUpdatingCurrentBranch:k=!1,isUpdatingAllBranches:u=!1,onReloadLocalBranches:te})=>{const[I,K]=a.useState(""),[V,f]=a.useState(null),[W,j]=a.useState(!1),[p,t]=a.useState({}),X=a.useRef(null),g=a.useRef(null),c=a.useRef(null),n=i||k||u;a.useEffect(()=>{n&&t({})},[n]);const v=(s,r)=>{n||t(l=>({...l,[r]:s}))},h=(s=>{const r={main:0,master:1,develop:2,staging:3};return[...s].sort((l,Q)=>{const U=r[l.name]??999,q=r[Q.name]??999;return U!==q?U-q:l.name.localeCompare(Q.name)})})(P),Z=h.length>0||i,E=h.map(s=>({...s,isCurrent:s.isCurrent!==void 0?s.isCurrent:s.current})).filter(s=>s.name.toLowerCase().includes(I.toLowerCase())),F=a.useCallback(()=>{!d||!m||!g.current||(c.current&&c.current.disconnect(),c.current=new IntersectionObserver(s=>{const[r]=s;r.isIntersecting&&d&&!i&&m()},{threshold:.5}),c.current.observe(g.current))},[d,m,i]);return a.useEffect(()=>(F(),()=>{c.current&&c.current.disconnect()}),[F,E.length]),i&&h.length===0?e.jsx("div",{className:o("w-full",x),children:e.jsx("div",{className:"animate-pulse space-y-3",children:[1,2,3,4,5].map(s=>e.jsx("div",{className:"h-14 bg-gray-200 rounded"},s))})}):h.length===0&&!i?e.jsx("div",{className:o("w-full p-4 text-center text-gray-500",x),children:"No branches found"}):e.jsxs("div",{className:o("w-full flex flex-col",x),children:[Z&&e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"relative flex-1 mr-2",children:[e.jsx(_,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(se,{type:"text",placeholder:"Search local branches...",value:I,onChange:s=>K(s.target.value),className:"pl-9 focus-visible:outline-none focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:border-input",disabled:n})]})}),e.jsx(re,{ref:X,className:"h-[calc(100vh-24rem)] overflow-auto pr-2 flex-1",children:e.jsxs("div",{className:"space-y-2",children:[E.map(s=>e.jsxs("div",{className:o("branch-item p-3 rounded-md border",s.isCurrent?"border-green-300 bg-green-50 hover:bg-green-50":"border-gray-200",!n&&!s.isCurrent&&"hover:bg-gray-50",n&&"opacity-75"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ne,{branchName:s.name,hasRemote:s.hasRemote}),e.jsxs("span",{className:o("font-medium",s.isCurrent?"font-semibold":"",s.hasRemote?"":"line-through text-gray-500"),children:[s.name,s.isCurrent&&e.jsx("span",{className:"ml-2 text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded-full",children:"current"})]})]}),e.jsx("div",{className:"flex space-x-2",children:s.isCurrent?s.hasRemote&&e.jsx(w,{children:e.jsxs(N,{open:p[`update-${s.name}`],onOpenChange:r=>v(r,`update-${s.name}`),children:[e.jsx(y,{asChild:!0,children:e.jsx("span",{children:e.jsxs(D,{open:W,onOpenChange:r=>{n||(j(r),r||t(l=>({...l,[`update-${s.name}`]:!1})))},children:[e.jsx(T,{asChild:!0,children:e.jsx(C,{size:"sm",onClick:()=>{n||(j(!0),t(r=>({...r,[`update-${s.name}`]:!1})))},variant:"secondary",className:"flex items-center bg-green-50 hover:bg-green-100 border-green-200 text-green-700",disabled:n,children:e.jsx(H,{size:16,className:k||u?"animate-spin":""})})}),e.jsxs($,{children:[e.jsxs(A,{children:[e.jsx(R,{children:"Update current branch?"}),e.jsx(S,{children:"This will fetch and update the current branch from its remote counterpart."})]}),e.jsxs(B,{children:[e.jsx(z,{onClick:()=>{t(r=>({...r,[`update-${s.name}`]:!1}))},children:"Cancel"}),e.jsx(O,{onClick:()=>{j(!1),t(r=>({...r,[`update-${s.name}`]:!1})),J()},children:"Update"})]})]})]})})}),e.jsx(b,{children:e.jsx("p",{children:"Update this branch"})})]})}):e.jsxs(e.Fragment,{children:[e.jsx(w,{children:e.jsxs(N,{open:p[`delete-${s.name}`],onOpenChange:r=>v(r,`delete-${s.name}`),children:[e.jsx(y,{asChild:!0,children:e.jsx("span",{children:e.jsxs(D,{onOpenChange:r=>{n||r||t(l=>({...l,[`delete-${s.name}`]:!1}))},children:[e.jsx(T,{asChild:!0,children:e.jsx(C,{variant:"secondary",size:"sm",onClick:()=>{n||t(r=>({...r,[`delete-${s.name}`]:!1}))},className:"flex items-center bg-red-50 hover:bg-red-100 border-red-200 text-red-600",disabled:n,children:e.jsx(L,{size:16})})}),e.jsxs($,{children:[e.jsxs(A,{children:[e.jsxs(R,{children:["Are you sure you want to delete ",e.jsx("span",{className:"font-mono",children:s.name}),"?"]}),e.jsx(S,{children:"This will permanently delete the branch."})]}),e.jsxs(B,{children:[e.jsx(z,{children:"Cancel"}),e.jsx(O,{onClick:()=>{t(r=>({...r,[`delete-${s.name}`]:!1})),G(s.name)},children:"Delete"})]})]})]})})}),e.jsx(b,{children:e.jsx("p",{children:"Delete this branch"})})]})}),e.jsx(w,{children:e.jsxs(N,{open:p[`switch-${s.name}`],onOpenChange:r=>v(r,`switch-${s.name}`),children:[e.jsx(y,{asChild:!0,children:e.jsx("span",{children:e.jsxs(D,{open:V===s.name,onOpenChange:r=>{n||(f(r?s.name:null),r||t(l=>({...l,[`switch-${s.name}`]:!1})))},children:[e.jsx(T,{asChild:!0,children:e.jsx(C,{variant:"secondary",size:"sm",onClick:()=>{n||(f(s.name),t(r=>({...r,[`switch-${s.name}`]:!1})))},className:"flex items-center bg-blue-50 hover:bg-blue-100 border-blue-200 text-blue-700",disabled:n,children:u&&s.hasRemote?e.jsx(H,{size:16,className:"animate-spin"}):e.jsx(M,{size:16})})}),e.jsxs($,{children:[e.jsxs(A,{children:[e.jsxs(R,{children:["Switch to branch ",e.jsx("span",{className:"font-mono",children:s.name}),"?"]}),e.jsx(S,{children:"You will switch your working directory to this branch."})]}),e.jsxs(B,{children:[e.jsx(z,{children:"Cancel"}),e.jsx(O,{onClick:()=>{f(null),t(r=>({...r,[`switch-${s.name}`]:!1})),Y(s.name)},children:"Switch"})]})]})]})})}),e.jsx(b,{children:e.jsx("p",{children:"Change to this branch"})})]})})]})})]}),!s.hasRemote&&e.jsxs("div",{className:"mt-2 flex items-center text-xs text-amber-600",children:[e.jsx(ee,{size:14,className:"mr-1"}),e.jsx("span",{children:"This branch no longer exists on the remote."})]})]},s.name)),d&&e.jsx("div",{ref:g,className:"py-4 flex justify-center",children:i?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-900"}):e.jsx("div",{className:"h-5 w-5"})})]})})]})};export{xe as default};
