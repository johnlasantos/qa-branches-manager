import{r as a,j as e,S as Z,q as _,s as L,v as M,w as ee}from"./vendor-D1edepek.js";import{B as v}from"./button-DrlrjpMV.js";import{I as se,S as re,B as ne}from"./BranchIcon-DBBp-a1m.js";import{c as o,T as C,a as w,b as N,d as y}from"./App-WfN5djmF.js";import{A as b,a as D,b as A,c as T,d as $,e as R,f as B,g as S,h as O}from"./alert-dialog-Dm4LHq-P.js";import"./index-Dn0d7mUv.js";const xe=({branches:H,onSwitchBranch:P,onDeleteBranch:Y,onUpdateCurrentBranch:G,onScrollEnd:m,hasMore:d=!1,className:x,isLoading:i=!1,isUpdatingCurrentBranch:k=!1,isUpdatingAllBranches:z=!1,onReloadLocalBranches:te})=>{const[I,J]=a.useState(""),[K,u]=a.useState(null),[V,f]=a.useState(!1),[j,t]=a.useState({}),W=a.useRef(null),p=a.useRef(null),c=a.useRef(null),n=i||k||z;a.useEffect(()=>{n&&t({})},[n]);const g=(s,r)=>{n||t(l=>({...l,[r]:s}))},h=(s=>{const r={main:0,master:1,develop:2,staging:3};return[...s].sort((l,F)=>{const Q=r[l.name]??999,q=r[F.name]??999;return Q!==q?Q-q:l.name.localeCompare(F.name)})})(H),X=h.length>0||i,U=h.map(s=>({...s,isCurrent:s.isCurrent!==void 0?s.isCurrent:s.current})).filter(s=>s.name.toLowerCase().includes(I.toLowerCase())),E=a.useCallback(()=>{!d||!m||!p.current||(c.current&&c.current.disconnect(),c.current=new IntersectionObserver(s=>{const[r]=s;r.isIntersecting&&d&&!i&&m()},{threshold:.5}),c.current.observe(p.current))},[d,m,i]);return a.useEffect(()=>(E(),()=>{c.current&&c.current.disconnect()}),[E,U.length]),i&&h.length===0?e.jsx("div",{className:o("w-full",x),children:e.jsx("div",{className:"animate-pulse space-y-3",children:[1,2,3,4,5].map(s=>e.jsx("div",{className:"h-14 bg-gray-200 rounded"},s))})}):h.length===0&&!i?e.jsx("div",{className:o("w-full p-4 text-center text-gray-500",x),children:"No branches found"}):e.jsxs("div",{className:o("w-full flex flex-col",x),children:[X&&e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"relative flex-1 mr-2",children:[e.jsx(Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(se,{type:"text",placeholder:"Search local branches...",value:I,onChange:s=>J(s.target.value),className:"pl-9 focus-visible:outline-none focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:border-input",disabled:n})]})}),e.jsx(re,{ref:W,className:"h-[calc(100vh-24rem)] overflow-auto pr-2 flex-1",children:e.jsxs("div",{className:"space-y-2",children:[U.map(s=>e.jsxs("div",{className:o("branch-item p-3 rounded-md border",s.isCurrent?"border-green-300 bg-green-50 hover:bg-green-50":"border-gray-200",!n&&!s.isCurrent&&"hover:bg-gray-50",n&&"opacity-75"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ne,{branchName:s.name,hasRemote:s.hasRemote}),e.jsxs("span",{className:o("font-medium",s.isCurrent?"font-semibold":"",s.hasRemote?"":"line-through text-gray-500"),children:[s.name,s.isCurrent&&e.jsx("span",{className:"ml-2 text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded-full",children:"current"})]})]}),e.jsx("div",{className:"flex space-x-2",children:s.isCurrent?s.hasRemote&&e.jsx(C,{children:e.jsxs(w,{open:j[`update-${s.name}`],onOpenChange:r=>g(r,`update-${s.name}`),children:[e.jsx(N,{asChild:!0,children:e.jsx("span",{children:e.jsxs(b,{open:V,onOpenChange:r=>{n||(f(r),r||t(l=>({...l,[`update-${s.name}`]:!1})))},children:[e.jsx(D,{asChild:!0,children:e.jsx(v,{size:"sm",onClick:()=>{n||(f(!0),t(r=>({...r,[`update-${s.name}`]:!1})))},variant:"secondary",className:"flex items-center bg-green-50 hover:bg-green-100 border-green-200 text-green-700",disabled:n,children:e.jsx(_,{size:16,className:k||z?"animate-spin":""})})}),e.jsxs(A,{children:[e.jsxs(T,{children:[e.jsx($,{children:"Update current branch?"}),e.jsx(R,{children:"This will fetch and update the current branch from its remote counterpart."})]}),e.jsxs(B,{children:[e.jsx(S,{onClick:()=>{t(r=>({...r,[`update-${s.name}`]:!1}))},children:"Cancel"}),e.jsx(O,{onClick:()=>{f(!1),t(r=>({...r,[`update-${s.name}`]:!1})),G()},children:"Update"})]})]})]})})}),e.jsx(y,{children:e.jsx("p",{children:"Update this branch"})})]})}):e.jsxs(e.Fragment,{children:[e.jsx(C,{children:e.jsxs(w,{open:j[`delete-${s.name}`],onOpenChange:r=>g(r,`delete-${s.name}`),children:[e.jsx(N,{asChild:!0,children:e.jsx("span",{children:e.jsxs(b,{onOpenChange:r=>{n||r||t(l=>({...l,[`delete-${s.name}`]:!1}))},children:[e.jsx(D,{asChild:!0,children:e.jsx(v,{variant:"secondary",size:"sm",onClick:()=>{n||t(r=>({...r,[`delete-${s.name}`]:!1}))},className:"flex items-center bg-red-50 hover:bg-red-100 border-red-200 text-red-600",disabled:n,children:e.jsx(L,{size:16})})}),e.jsxs(A,{children:[e.jsxs(T,{children:[e.jsxs($,{children:["Are you sure you want to delete ",e.jsx("span",{className:"font-mono",children:s.name}),"?"]}),e.jsx(R,{children:"This will permanently delete the branch."})]}),e.jsxs(B,{children:[e.jsx(S,{children:"Cancel"}),e.jsx(O,{onClick:()=>{t(r=>({...r,[`delete-${s.name}`]:!1})),Y(s.name)},children:"Delete"})]})]})]})})}),e.jsx(y,{children:e.jsx("p",{children:"Delete this branch"})})]})}),e.jsx(C,{children:e.jsxs(w,{open:j[`switch-${s.name}`],onOpenChange:r=>g(r,`switch-${s.name}`),children:[e.jsx(N,{asChild:!0,children:e.jsx("span",{children:e.jsxs(b,{open:K===s.name,onOpenChange:r=>{n||(u(r?s.name:null),r||t(l=>({...l,[`switch-${s.name}`]:!1})))},children:[e.jsx(D,{asChild:!0,children:e.jsx(v,{variant:"secondary",size:"sm",onClick:()=>{n||(u(s.name),t(r=>({...r,[`switch-${s.name}`]:!1})))},className:"flex items-center bg-blue-50 hover:bg-blue-100 border-blue-200 text-blue-700",disabled:n,children:e.jsx(M,{size:16})})}),e.jsxs(A,{children:[e.jsxs(T,{children:[e.jsxs($,{children:["Switch to branch ",e.jsx("span",{className:"font-mono",children:s.name}),"?"]}),e.jsx(R,{children:"You will switch your working directory to this branch."})]}),e.jsxs(B,{children:[e.jsx(S,{children:"Cancel"}),e.jsx(O,{onClick:()=>{u(null),t(r=>({...r,[`switch-${s.name}`]:!1})),P(s.name)},children:"Switch"})]})]})]})})}),e.jsx(y,{children:e.jsx("p",{children:"Change to this branch"})})]})})]})})]}),!s.hasRemote&&e.jsxs("div",{className:"mt-2 flex items-center text-xs text-amber-600",children:[e.jsx(ee,{size:14,className:"mr-1"}),e.jsx("span",{children:"This branch no longer exists on the remote."})]})]},s.name)),d&&e.jsx("div",{ref:p,className:"py-4 flex justify-center",children:i?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-900"}):e.jsx("div",{className:"h-5 w-5"})})]})})]})};export{xe as default};
